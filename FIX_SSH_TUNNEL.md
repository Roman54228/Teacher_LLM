# Исправление SSH туннеля для Telegram Mini App

## Проблема
Ошибка: `connect_to localhost port 5000: failed`

## Причина
SSH туннель пытается подключиться к localhost:5000, но приложение работает на 127.0.0.1:5000 или 0.0.0.0:5000

## Решение

### Вариант 1: Правильная команда туннеля
```bash
ssh -R 80:127.0.0.1:5000 localhost.run
```

### Вариант 2: Если не работает, попробуйте:
```bash
ssh -R 80:0.0.0.0:5000 localhost.run
```

### Вариант 3: Универсальный туннель
```bash
ssh -R 5000:localhost:5000 localhost.run
```

## Пошаговое исправление

1. **Остановите старый туннель** (Ctrl+C в терминале с SSH)

2. **Убедитесь что приложение работает:**
   ```bash
   curl http://127.0.0.1:5000
   ```

3. **Запустите правильный туннель:**
   ```bash
   ssh -R 80:127.0.0.1:5000 localhost.run
   ```

4. **Скопируйте полученный URL** (например: https://abc123.localhost.run)

5. **Обновите config.yaml:**
   ```yaml
   telegram:
     bot_token: "ваш_токен"
     web_app_url: "https://abc123.localhost.run"
   ```

6. **Перезапустите бота:**
   ```bash
   python telegram_bot_simple.py
   ```

## Если туннель все равно не работает

### Альтернатива: Тестирование без туннеля
Пока можно тестировать основные функции бота:
- Кнопки "О боте" и "Статистика" должны работать
- Веб-интерфейс доступен по http://localhost:5000

### Другие туннельные сервисы:
```bash
# Попробуйте serveo.net
ssh -R 80:127.0.0.1:5000 serveo.net

# Или установите ngrok
# npm install -g ngrok
# ngrok http 5000
```

## Проверка работы

1. **В терминале с туннелем** должно появиться:
   ```
   Your tunnel is now publicly accessible:
   https://abc123.localhost.run
   ```

2. **Откройте этот URL в браузере** - должно открыться приложение

3. **В Telegram боте** кнопка "Начать подготовку" должна открыть Mini App

## Команды для быстрого исправления

```bash
# Остановить все процессы
pkill -f "ssh.*localhost.run"

# Проверить что приложение работает
curl http://127.0.0.1:5000

# Запустить правильный туннель
ssh -R 80:127.0.0.1:5000 localhost.run
```